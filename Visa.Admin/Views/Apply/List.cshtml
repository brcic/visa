@model IEnumerable<Visa.Domain.AppointView>
<script src="/layer/layer.js"></script>
<script type="text/javascript">
    function checkdel(id) {

        layer.confirm('确实要删除吗？', function () {
            var layerid = layer.msg('验证中...', { icon: 16, time: 0, shade: [0.6, '#000', true] });
            $.ajax({
                type: 'POST',
                url: '/Apply/Delete',
                data: { id: id },
                dataType: 'json',
                success: function (data) {
                    layer.closeAll();
                    if (data.status == "1")
                        window.location.reload();
                    else
                        layer.msg("你没有权限,请联系管理员！", { time: 3000 });
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    layer.closeAll();
                    if (XMLHttpRequest.status == "499")
                        layer.msg("你没有权限,请联系管理员！", { time: 3000 });
                    else
                        layer.msg("保存失败！" + textStatus, { time: 3000 });
                }
            });
        });
    }

    function checkfind() {
        var url = "/Apply/List?s=pf";
        var country = $("#SelectCountry").val();
        if (country != "")
            url += "&country=" + country;

        var number = $("#textNumer").val();
        if (number != "")
            url += "&number=" + number;

        var phone = $("#textPhone").val();
        if (phone != "")
            url += "&phone=" + phone;
        var mail = $("#textEmail").val();
        if (mail != "")
            url += "&mail=" + encodeURI(mail);

        var stime = $("#textStime").val();
        if (stime != "")
            url += "&stime=" + encodeURI(stime);
        window.location.href = url;
    }
    $(function () {
        $(document).keypress(function (event) {
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if (keycode == '13') { checkfind(); }
        });
    });
</script>
<!-- #section:basics/content.breadcrumbs -->
<div class="breadcrumbs" id="breadcrumbs">
    <script type="text/javascript">
        try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
    </script>

    <ul class="breadcrumb">
        <li>
            <i class="ace-icon fa fa-home home-icon"></i>
            <a href="###">预约管理</a>
        </li>
        <li>
            预约记录
        </li>
    </ul><!-- /.breadcrumb -->
</div>
<!-- /section:basics/content.breadcrumbs -->
<div class="page-content">
    @Html.Partial("_PartialSetting")
    <div class="row">
        <div class="col-xs-12">
            <table border="0" cellspacing="0" cellpadding="0" class="table table-bordered">
                <tbody>
                    <tr>
                        <td class="active right">
                            目的国家
                        </td>
                        <td>
                            @Html.DropDownList("SelectCountry", ViewData["vcountry"] as List<SelectListItem>)
                        </td>
                        <td class="active right">
                            预约序号
                        </td>
                        <td>
                            <input type="text" id="textNumer" class="input-sm" value="@ViewData["vnumber"]" />
                        </td>
                        <td class="active right">
                            预约人手机
                        </td>
                        <td>
                            <input type="text" id="textPhone" class="input-sm" value="@ViewData["vphone"]" />
                        </td>
                       
                    </tr>
                    <tr>
                        <td class="active right">
                            预约人邮箱
                        </td>
                        <td>
                            <input type="text" id="textEmail" class="input-sm" value="@ViewData["vmail"]" />
                        </td>
                        <td class="active right">
                            预约日期
                        </td>
                        <td  colspan="2">
                            <input type="text" id="textStime" class="input-sm" value="@ViewData["vstime"]" />
                        </td>
                      
                        <td>
                            <a class="btn btn-sm btn-pink" href="javascript:checkfind()" aria-label="Left Align">
                                <i class="fa fa-search bigger-120"></i>查询
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table id="simple-table" class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th>预约序号</th>
                        <th>签证国家</th>
                        <th>签证类型</th>
                        <th>当前国籍</th>
                        <th>创建时间</th>
                        <th>预约时间</th>
                        <th>预约操作人</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr id="tr_@item.Id">
                            <td>@item.ApplyNumber</td>
                            <td>@item.ChineseName</td>
                            <td>@item.QzType</td>
                            <td>@item.Residence</td>
                            <td>@item.AddTime</td>
                            <td>@item.DateName @item.TimeRange</td>
                            <td>@item.Surname @item.Givename</td>
                            @if (item.CheckStatus == 0)
                            {
                                <td>未完成</td>
                            }
                            else
                            {
                                <td style="color:#ff0000">已完成</td>
                            }
                            <td>
                                <div class="hidden-sm hidden-xs btn-group">
                                    <a href="/Apply/Applicant?applynumber=@item.ApplyNumber&burl=@ViewData["vburl"]" class="btn btn-xs btn-info">
                                        <i class="ace-icon fa fa-pencil bigger-120"></i>查看预约详情
                                    </a>
                                    <a href="javascript:checkdel(@item.Id)" class="btn btn-xs btn-info">
                                        <i class="ace-icon fa fa-trash-o bigger-120"></i>删除
                                    </a>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
            @Html.Raw(ViewData["PageHtml"])
        </div>
    </div>
</div>
